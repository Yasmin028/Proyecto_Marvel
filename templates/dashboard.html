{% extends 'base.html' %}

{% block content %}
<section class="section bg-estelar">
  <div class="container">
  <h1 class="title has-text-warning has-text-centered" style="font-size: 8rem;">
      ðŸ“Š DASHBOARD MARVEL
    </h1>

    <!-- âœ… KPIs horizontales -->
    <div class="columns is-centered mt-5">

      <div class="column is-one-quarter">
        <div class="dashboard-card">
          <p class="kpi-number">{{ total_peliculas }}</p>
          <p class="kpi-label">PelÃ­culas Registradas</p>
        </div>
      </div>

      <div class="column is-one-quarter">
        <div class="dashboard-card">
          <p class="kpi-number">{{ total_personajes }}</p>
          <p class="kpi-label">Personajes Registrados</p>
        </div>
      </div>

      <div class="column is-one-quarter">
        <div class="dashboard-card">
          <p class="kpi-number">{{ total_directores }}</p>
          <p class="kpi-label">Directores Registrados</p>
        </div>
      </div>

    </div>

    <!-- âœ… GrÃ¡ficas en dos columnas -->
    <div class="columns mt-6">

      <div class="column is-half">
        <div class="dashboard-box">
          <h2 class="dashboard-title has-text-danger">ðŸŽ¬ PelÃ­culas por AÃ±o</h2>
          <canvas id="peliculasPorAnio"></canvas>
        </div>
      </div>

      <div class="column is-half">
        <div class="dashboard-box">
          <h2 class="dashboard-title has-text-warning">ðŸ¦¸ Estado de Personajes</h2>
          <canvas id="estadoPersonajes"></canvas>
        </div>
      </div>

    </div>

    <!-- âœ… GrÃ¡fica completa abajo -->
    <div class="dashboard-box mt-5">
      <h2 class="dashboard-title has-text-info">ðŸŽ¥ PelÃ­culas por Director</h2>
      <canvas id="peliculasPorDirector"></canvas>
    </div>

  </div>
</section>

<!-- âœ… Scripts -->
<script>
  const peliculasPorAnio = {{ peliculas_por_anio | safe }};
  const estadoPersonajes = {{ estado_personajes | safe }};
  const peliculasPorDirector = {{ peliculas_por_director | safe }};

  const marvelRed = "#ED1D24";
  const marvelBlue = "#0A7BFF";
  const marvelGold = "#F2C300";
  const marvelWhite = "#FFFFFF";

  new Chart(document.getElementById("peliculasPorAnio"), {
    type: "bar",
    data: {
      labels: peliculasPorAnio.labels,
      datasets: [{
        label: "PelÃ­culas",
        data: peliculasPorAnio.data,
        backgroundColor: marvelRed
      }]
    },
    options: {
      plugins: { legend: { labels: { color: marvelWhite } } },
      scales: {
        x: { ticks: { color: marvelWhite } },
        y: { ticks: { color: marvelWhite } }
      }
    }
  });

  new Chart(document.getElementById("estadoPersonajes"), {
    type: "pie",
    data: {
      labels: ["Activos", "Eliminados"],
      datasets: [{
        data: estadoPersonajes,
        backgroundColor: [marvelBlue, marvelRed]
      }]
    }
  });

  new Chart(document.getElementById("peliculasPorDirector"), {
    type: "bar",
    data: {
      labels: peliculasPorDirector.labels,
      datasets: [{
        label: "PelÃ­culas",
        data: peliculasPorDirector.data,
        backgroundColor: marvelGold
      }]
    },
    options: {
      plugins: { legend: { labels: { color: marvelWhite } } },
      scales: {
        x: { ticks: { color: marvelWhite } },
        y: { ticks: { color: marvelWhite } }
      }
    }
  });
</script>

{% endblock %}