{% extends "base.html" %}
{% block content %}
<section class="section" style="
  background: url('/static/img/stars-bg.jpg') center center / cover no-repeat;
  min-height: 100vh;
  padding: 3rem;
">
  <h1 class="title has-text-warning has-text-centered" style="font-size: 6rem;"> Resultados para “{{ q }}”</h1>

  {% if mensaje %}
    <div class="notification is-warning has-text-centered is-size-4" style="margin-top: 2rem;">
      ⚠️ {{ mensaje }}
    </div>
  {% endif %}

  {# ============================
     ✅ PELÍCULAS
     ============================ #}
  {% if peliculas %}
    <h2 class="title has-text-warning">Películas</h2>
    <div class="columns is-multiline">
      {% for pelicula in peliculas %}
        <div class="column is-one-quarter">
          <a href="/peliculas/page#card-{{ pelicula.id }}">
            <div class="card has-background-black" style="border:2px solid #e62429;">
              <div class="card-image">
                {% if pelicula.imagen_data %}
                  <img src="data:image/png;base64,{{ pelicula.imagen_data | b64encode }}" alt="{{ pelicula.titulo }}">
                {% elif pelicula.imagen_url %}
                  <img src="{{ pelicula.imagen_url }}" alt="{{ pelicula.titulo }}">
                {% else %}
                  <div class="placeholder"><span class="placeholder-text">SIN IMAGEN</span></div>
                {% endif %}
              </div>
              <div class="card-content has-text-centered">
                <p class="title is-4 has-text-warning">{{ pelicula.titulo }}</p>
                <p class="subtitle is-6 has-text-grey-light">{{ pelicula.año or "No especificado" }}</p>
              </div>
            </div>
          </a>
        </div>
      {% endfor %}
    </div>
  {% endif %}

  {# ============================
     ✅ PERSONAJES
     ============================ #}
  {% if personajes %}
    <h2 class="title has-text-warning">Personajes</h2>
    <div class="columns is-multiline">
      {% for personaje in personajes %}
        <div class="column is-one-quarter">
          <a href="/personajes/page#card-{{ personaje.id }}">
            <div class="card has-background-black" style="border:2px solid #e62429;">
              <div class="card-image">
                {% if personaje.imagen_data %}
                  <img src="data:image/png;base64,{{ personaje.imagen_data | b64encode }}" alt="{{ personaje.nombre }}">
                {% elif personaje.imagen_url %}
                  <img src="{{ personaje.imagen_url }}" alt="{{ personaje.nombre }}">
                {% else %}
                  <div class="placeholder"><span class="placeholder-text">SIN IMAGEN</span></div>
                {% endif %}
              </div>
              <div class="card-content has-text-centered">
                <p class="title is-4 has-text-warning">{{ personaje.nombre }}</p>
                <p class="subtitle is-6 has-text-grey-light">{{ personaje.poder }}</p>
              </div>
            </div>
          </a>
        </div>
      {% endfor %}
    </div>
  {% endif %}

  {# ============================
     ✅ DIRECTORES
     ============================ #}
  {% if directores %}
    <h2 class="title has-text-warning">Directores</h2>
    <div class="columns is-multiline">
      {% for director in directores %}
        <div class="column is-one-quarter">
          <a href="/directores/page#card-{{ director.id }}">
            <div class="card has-background-black" style="border:2px solid #e62429;">
              <div class="card-image">
                {% if director.imagen_data %}
                  <img src="data:image/png;base64,{{ director.imagen_data | b64encode }}" alt="{{ director.nombre }}">
                {% elif director.imagen_url %}
                  <img src="{{ director.imagen_url }}" alt="{{ director.nombre }}">
                {% else %}
                  <div class="placeholder"><span class="placeholder-text">SIN IMAGEN</span></div>
                {% endif %}
              </div>
              <div class="card-content has-text-centered">
                <p class="title is-4 has-text-warning">{{ director.nombre }}</p>
              </div>
            </div>
          </a>
        </div>
      {% endfor %}
    </div>
  {% endif %}

  {# ============================
     ✅ CURIOSIDADES
     ============================ #}
  {% if curiosidades %}
    <h2 class="title has-text-warning">Curiosidades</h2>
    <div class="columns is-multiline">
      {% for curiosidad in curiosidades %}
        <div class="column is-one-quarter">
          <a href="/curiosidades/page#card-{{ curiosidad.id }}">
            <div class="card has-background-black" style="border:2px solid #e62429;">
              <div class="card-image">
                {% if curiosidad.pelicula and curiosidad.pelicula.imagen_data %}
                  <img src="data:image/png;base64,{{ curiosidad.pelicula.imagen_data | b64encode }}" alt="Curiosidad">
                {% elif curiosidad.pelicula and curiosidad.pelicula.imagen_url %}
                  <img src="{{ curiosidad.pelicula.imagen_url }}" alt="Curiosidad">
                {% else %}
                  <div class="placeholder"><span class="placeholder-text">SIN IMAGEN</span></div>
                {% endif %}
              </div>
              <div class="card-content has-text-centered">
                <p class="title is-4 has-text-warning">{{ curiosidad.pelicula.titulo }}</p>
                <p class="subtitle is-6 has-text-grey-light">{{ curiosidad.contenido }}</p>
              </div>
            </div>
          </a>
        </div>
      {% endfor %}
    </div>
  {% endif %}

</section>
{% endblock %}