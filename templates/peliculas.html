{% extends 'base.html' %}

{% block content %}
<h2 class="title">Películas</h2>

<!-- Formulario para registrar película con imagen -->
<form action="/peliculas" method="post" enctype="multipart/form-data" class="box">
  <div class="field">
    <label class="label">Título</label>
    <input class="input" type="text" name="titulo" required>
  </div>
  <div class="field">
    <label class="label">Año</label>
    <input class="input" type="number" name="año" min="1900" max="2025" required>
  </div>
  <div class="field">
    <label class="label">Director</label>
    <input class="input" type="text" name="director_nombre" required>
  </div>
  <div class="field">
    <label class="label">Imagen</label>
    <input class="file-input" type="file" name="imagen" accept="image/*">
  </div>
  <button class="button is-primary">Registrar Película</button>
</form>

<hr>

<h3 class="subtitle">Listado de Películas</h3>
<table class="table is-striped is-fullwidth">
  <thead>
    <tr>
      <th>ID</th>
      <th>Título</th>
      <th>Año</th>
      <th>Director</th>
      <th>Imagen</th>
      <th>Estado</th>
    </tr>
  </thead>
  <tbody>
    {% for pelicula in peliculas %}
    <tr>
      <td>{{ pelicula.id }}</td>
      <td>{{ pelicula.titulo }}</td>
      <td>{{ pelicula.año }}</td>
      <td>{{ pelicula.director_nombre }}</td>
      <td>
        {% if pelicula.imagen_url %}
          <img src="{{ pelicula.imagen_url }}" alt="Poster" style="width:80px;height:80px;object-fit:cover;">
        {% else %}
          <span class="tag is-light">Sin imagen</span>
        {% endif %}
      </td>
      <td>{{ "Activa" if pelicula.estado else "Eliminada" }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}